<BOUCLE_tous (DOCUMENTS types_documents) {id_document=#ID} {tout}>
#SET{largeur,#ENV{largeur, #LARGEUR|?{#LARGEUR,400}}|max{120}}
<div	class='spip_document_#ID_DOCUMENT spip_document_audio spip_documents[ spip_documents_(#ENV{align})]'
	style='[(#ENV{align}|match{^(left|right)$}|oui)float:#ENV{align};][width:(#GET{largeur})px]'>
	[(#LOGO_DOCUMENT{vignette}|image_reduire{#GET{largeur},0}|vider_attribut{class})]
<div class="audio-wrapper"[ style='width:(#GET{largeur})px;max-width:100%;']>
	<audio class="mejs mejs-#ID_DOCUMENT [ mejs-(#ENV{skin})]"
	       data-id="[(#VAL{mejs-#ID_DOCUMENT}|concat{#ENV{skin}}|md5)]"
	       src="#FICHIER"
	       type="#MIME_TYPE"
	       data-mejsoptions='{"alwaysShowControls": true[,"loop":(#ENV{loop}|?{true,false})],"audioWidth":"100%"[,audioHeight:"(#ENV{hauteur})"][,startVolume:"(#ENV{volume})"]}'
	       controls="controls"
				 [autoplay="autoplay"(#ENV{autoplay}|oui)]></audio>
</div>
[<div class='spip_doc_titre'><strong>(#TITRE)</strong></div>]
[<div class='spip_doc_descriptif'>(#DESCRIPTIF|PtoBR)[(#NOTES|PtoBR)]</div>]
<script>/*<![CDATA[*/
	var mejsloader;
	(function(){
		var mejs_counter = 0;
		function mejs_init(){
			(function($) {
				jQuery("audio.mejs").each(function(){
					console.log(this);
					mejs_counter++;
					var id = "mejs-" + (jQuery(this).attr('data-id')) + "-" + mejs_counter;
					var autoplay = jQuery(this).attr('autoplay');
					jQuery(this).attr('id',id);
					var options = jQuery(this).attr('data-mejsoptions');
					if (options)
						eval("options="+options+";");
					else
						options = {};
					new MediaElementPlayer('#'+id,jQuery.extend(options,{
						"success": function(media) {
							if (autoplay) media.play();
						}
					}));
				})
			})(jQuery);
		}
		if (typeof mejsloader=="undefined"){
			mejsloader = jQuery.getScript("#CHEMIN{lib/mejs/mediaelement-and-player.min.js}",function(){
				mejs_init(); // init immediate des premiers players dans la page
				jQuery(mejs_init); // init exhaustive de tous les players
				onAjaxLoad(mejs_init); // init lors d'un load ajax
			});
		}
	})();
/*]]>*/</script>
<link rel="stylesheet" href="#CHEMIN{lib/mejs/mediaelementplayer.min.css}" />
</div>
</BOUCLE_tous>